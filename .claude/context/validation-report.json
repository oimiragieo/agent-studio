{
  "timestamp": "2026-01-06T05:00:00.000Z",
  "overall_status": "PARTIAL",
  "validations": [
    {
      "name": "pnpm validate",
      "status": "FAIL",
      "details": "79 errors found, 4 warnings",
      "errors": [
        "YAML syntax error in bmad-greenfield-standard.yaml at line 304 - bad indentation",
        "73 skills missing 'version' field",
        "5 skills missing 'allowed-tools' field"
      ]
    },
    {
      "name": "pnpm cuj:doctor",
      "status": "WARN",
      "details": "1 critical issue, 131 warnings",
      "errors": [
        "CUJ count drift: Docs (59) match Registry (59), but Index shows 0 (likely parsing issue)",
        "2 broken links: CUJ-056 -> STATELESS_RECOVERY.md, CUJ-061 -> artifact-registry.json",
        "59 CUJs missing platforms array in registry",
        "59 CUJs missing success_criteria array in registry",
        "59 CUJs with invalid execution_mode (workflow/skill-only/manual-setup instead of automated/assisted/manual)"
      ]
    },
    {
      "name": "CUJ Document Count",
      "status": "PASS",
      "details": "59 CUJ docs exist, 59 CUJs in registry - counts match",
      "errors": []
    },
    {
      "name": "CUJ Registry Integrity",
      "status": "WARN",
      "details": "Registry exists but has schema compliance issues",
      "errors": [
        "Malformed workflow path at line 1931: '.claude/workflows/.claude/workflows/artifact-publishing-flow.yaml'",
        "Only 15 of 21 workflow CUJs have workflow field populated"
      ]
    },
    {
      "name": "Workflow YAML Syntax",
      "status": "FAIL",
      "details": "13 of 14 workflows valid, 1 has syntax error",
      "errors": ["bmad-greenfield-standard.yaml: bad indentation at line 304"]
    },
    {
      "name": "Step 0.1 Plan Rating Gate",
      "status": "PARTIAL",
      "details": "8 of 14 workflows have Step 0.1 with response-rater",
      "errors": [
        "Missing Step 0.1: performance-flow.yaml",
        "Missing Step 0.1: incident-flow.yaml",
        "Missing Step 0.1: browser-testing-flow.yaml",
        "Missing Step 0.1: quick-flow.yaml",
        "Missing Step 0.1: ui-perfection-loop.yaml",
        "Missing Step 0.1: automated-enterprise-flow.yaml"
      ]
    },
    {
      "name": "Skill Metadata (openai-api)",
      "status": "PASS",
      "details": "Valid YAML frontmatter with version 2.0.0",
      "errors": []
    },
    {
      "name": "Skill Metadata (pinecone-vector)",
      "status": "PASS",
      "details": "Valid YAML frontmatter with version 1.0.0",
      "errors": []
    },
    {
      "name": "Broken Links",
      "status": "FAIL",
      "details": "2 broken links found in CUJ documentation",
      "errors": [
        "CUJ-056: ../STATELESS_RECOVERY.md does not exist",
        "CUJ-061: ../../context/artifact-registry.json does not exist"
      ]
    },
    {
      "name": "Execution Mode Normalization",
      "status": "WARN",
      "details": "Registry uses legacy modes (workflow/skill-only/manual-setup) instead of normalized (automated/assisted/manual)",
      "errors": [
        "All 59 CUJs have non-standard execution_mode values",
        "Expected: automated, assisted, manual",
        "Found: workflow (21), skill-only (36), manual-setup (2)"
      ]
    },
    {
      "name": "cuj:doctor JSON output",
      "status": "PASS",
      "details": "JSON output mode works correctly",
      "errors": []
    },
    {
      "name": "Agent References",
      "status": "PASS",
      "details": "All workflow agent references verified (from cuj-doctor)",
      "errors": []
    },
    {
      "name": "Skill References",
      "status": "PASS",
      "details": "All skill references verified (from cuj-doctor)",
      "errors": []
    }
  ],
  "summary": {
    "passed": 7,
    "failed": 3,
    "warnings": 3
  },
  "recommendations": [
    {
      "priority": "HIGH",
      "issue": "Fix YAML syntax error in bmad-greenfield-standard.yaml",
      "action": "Correct indentation at line 304 - step 4.7 is indented incorrectly inside the decision block",
      "file": ".claude/workflows/bmad-greenfield-standard.yaml"
    },
    {
      "priority": "HIGH",
      "issue": "Fix malformed workflow path in registry",
      "action": "Change '.claude/workflows/.claude/workflows/artifact-publishing-flow.yaml' to '.claude/workflows/artifact-publishing-flow.yaml'",
      "file": ".claude/context/cuj-registry.json"
    },
    {
      "priority": "MEDIUM",
      "issue": "Add Step 0.1 Plan Rating Gate to remaining workflows",
      "action": "Add Step 0.1 with response-rater skill to: performance-flow.yaml, incident-flow.yaml, browser-testing-flow.yaml, quick-flow.yaml, ui-perfection-loop.yaml, automated-enterprise-flow.yaml",
      "files": [
        ".claude/workflows/performance-flow.yaml",
        ".claude/workflows/incident-flow.yaml",
        ".claude/workflows/browser-testing-flow.yaml",
        ".claude/workflows/quick-flow.yaml",
        ".claude/workflows/ui-perfection-loop.yaml",
        ".claude/workflows/automated-enterprise-flow.yaml"
      ]
    },
    {
      "priority": "MEDIUM",
      "issue": "Create missing documentation files",
      "action": "Create STATELESS_RECOVERY.md and artifact-registry.json (or update broken links)",
      "files": [".claude/docs/STATELESS_RECOVERY.md", ".claude/context/artifact-registry.json"]
    },
    {
      "priority": "MEDIUM",
      "issue": "Add version field to 73 skills",
      "action": "Add 'version: 1.0.0' to YAML frontmatter of skills missing this field",
      "count": 73
    },
    {
      "priority": "LOW",
      "issue": "Normalize execution_mode values in registry",
      "action": "Update cuj-registry.json or sync script to map: workflow->automated, skill-only->assisted, manual-setup->manual",
      "file": ".claude/context/cuj-registry.json"
    },
    {
      "priority": "LOW",
      "issue": "Add platforms and success_criteria arrays to registry",
      "action": "Update sync script to populate these fields from CUJ docs",
      "file": ".claude/context/cuj-registry.json"
    },
    {
      "priority": "LOW",
      "issue": "Populate workflow field for remaining CUJs",
      "action": "6 workflow-type CUJs have null workflow field - should reference actual YAML files",
      "count": 6
    }
  ],
  "files_checked": {
    "cuj_docs": 59,
    "cuj_registry_entries": 59,
    "workflow_yamls": 14,
    "workflow_yamls_valid": 13,
    "workflows_with_step_01": 8,
    "skills_validated": 79,
    "skills_with_errors": 73
  },
  "next_steps": [
    "1. Fix bmad-greenfield-standard.yaml YAML syntax error (blocking)",
    "2. Fix malformed workflow path in cuj-registry.json",
    "3. Add Step 0.1 to 6 remaining workflows",
    "4. Create or fix broken documentation links",
    "5. Run 'pnpm validate' again to verify fixes"
  ]
}
