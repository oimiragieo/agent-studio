{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://llm-rules.com/schemas/security-review.schema.json",
  "title": "Security Review",
  "description": "Security review artifact for security assessment and vulnerability analysis",
  "type": "object",
  "required": [
    "review_id",
    "timestamp",
    "reviewer",
    "scope",
    "vulnerabilities",
    "security_score",
    "recommendations"
  ],
  "properties": {
    "review_id": {
      "type": "string",
      "description": "Unique identifier for the security review"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp of review",
      "format": "date-time"
    },
    "reviewer": {
      "type": "string",
      "description": "Agent or user who performed the review"
    },
    "scope": {
      "type": "object",
      "description": "Scope of the security review",
      "required": ["components", "review_type"],
      "properties": {
        "components": {
          "type": "array",
          "description": "Components reviewed",
          "items": {
            "type": "string"
          }
        },
        "review_type": {
          "type": "string",
          "enum": ["full", "partial", "targeted", "compliance"],
          "description": "Type of security review"
        },
        "standards": {
          "type": "array",
          "description": "Security standards assessed against",
          "items": {
            "type": "string",
            "enum": ["OWASP", "NIST", "CWE", "GDPR", "HIPAA", "PCI-DSS", "SOC2"]
          }
        }
      }
    },
    "vulnerabilities": {
      "type": "array",
      "description": "Security vulnerabilities found",
      "items": {
        "type": "object",
        "required": ["id", "severity", "category", "description", "affected_component"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique vulnerability identifier"
          },
          "severity": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low", "info"]
          },
          "category": {
            "type": "string",
            "enum": [
              "injection",
              "authentication",
              "authorization",
              "data_exposure",
              "xss",
              "csrf",
              "misconfiguration",
              "cryptographic_failure",
              "insecure_deserialization",
              "dependency_vulnerability",
              "logging_monitoring",
              "other"
            ]
          },
          "description": {
            "type": "string",
            "minLength": 20
          },
          "affected_component": {
            "type": "string",
            "description": "Component or file affected"
          },
          "cwe_id": {
            "type": "string",
            "description": "CWE identifier",
            "pattern": "^CWE-[0-9]+$"
          },
          "cvss_score": {
            "type": "number",
            "minimum": 0,
            "maximum": 10
          },
          "exploitation_difficulty": {
            "type": "string",
            "enum": ["trivial", "easy", "medium", "hard", "very_hard"]
          },
          "remediation": {
            "type": "string",
            "description": "Recommended fix"
          },
          "references": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "security_score": {
      "type": "number",
      "description": "Overall security score (0-100)",
      "minimum": 0,
      "maximum": 100
    },
    "security_controls": {
      "type": "object",
      "description": "Assessment of security controls",
      "properties": {
        "authentication": {
          "type": "string",
          "enum": ["strong", "adequate", "weak", "none", "not_applicable"]
        },
        "authorization": {
          "type": "string",
          "enum": ["strong", "adequate", "weak", "none", "not_applicable"]
        },
        "data_encryption": {
          "type": "string",
          "enum": ["strong", "adequate", "weak", "none", "not_applicable"]
        },
        "input_validation": {
          "type": "string",
          "enum": ["comprehensive", "partial", "minimal", "none"]
        },
        "secrets_management": {
          "type": "string",
          "enum": ["strong", "adequate", "weak", "none", "not_applicable"]
        },
        "logging_monitoring": {
          "type": "string",
          "enum": ["comprehensive", "partial", "minimal", "none"]
        }
      }
    },
    "compliance_status": {
      "type": "object",
      "description": "Compliance assessment",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "compliant": {
            "type": "boolean"
          },
          "gaps": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
    "recommendations": {
      "type": "array",
      "description": "Security recommendations",
      "items": {
        "type": "object",
        "required": ["priority", "description"],
        "properties": {
          "priority": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"]
          },
          "description": {
            "type": "string",
            "minLength": 10
          },
          "implementation_effort": {
            "type": "string",
            "enum": ["low", "medium", "high"]
          }
        }
      }
    },
    "risk_assessment": {
      "type": "object",
      "properties": {
        "overall_risk": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"]
        },
        "risk_factors": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "review_notes": {
      "type": "string",
      "description": "Additional notes from the security review"
    }
  }
}
