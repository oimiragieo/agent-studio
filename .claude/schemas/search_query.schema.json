{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://llm-rules.dev/schemas/search_query.schema.json",
  "title": "Search Query Schema",
  "description": "Schema for analyzed search query with semantic expansion and filter parameters",
  "type": "object",
  "required": ["query", "search_intent", "keywords", "timestamp"],
  "properties": {
    "query": {
      "type": "string",
      "description": "Original user search query",
      "minLength": 1,
      "maxLength": 500
    },
    "search_intent": {
      "type": "string",
      "description": "Parsed search intent (e.g., 'find_pattern', 'find_documentation', 'find_usage')",
      "enum": [
        "find_pattern",
        "find_documentation",
        "find_usage",
        "find_implementation",
        "find_example",
        "general_search"
      ]
    },
    "keywords": {
      "type": "array",
      "description": "Extracted key search terms",
      "items": {
        "type": "string",
        "minLength": 1
      },
      "minItems": 1,
      "uniqueItems": true
    },
    "expanded_terms": {
      "type": "array",
      "description": "Semantically expanded search terms for broader matching",
      "items": {
        "type": "string"
      },
      "uniqueItems": true
    },
    "filters": {
      "type": "object",
      "description": "Search filters to apply",
      "properties": {
        "file_types": {
          "type": "array",
          "description": "Limit search to specific file extensions",
          "items": {
            "type": "string",
            "pattern": "^\\.[a-z0-9]+$"
          }
        },
        "date_range": {
          "type": "object",
          "properties": {
            "from": {
              "type": "string",
              "format": "date-time"
            },
            "to": {
              "type": "string",
              "format": "date-time"
            }
          }
        },
        "categories": {
          "type": "array",
          "description": "Document categories to include",
          "items": {
            "type": "string"
          }
        },
        "max_results": {
          "type": "integer",
          "description": "Maximum number of results to return",
          "minimum": 1,
          "maximum": 1000,
          "default": 50
        }
      }
    },
    "search_parameters": {
      "type": "object",
      "description": "Advanced search parameters",
      "properties": {
        "relevance_threshold": {
          "type": "number",
          "description": "Minimum relevance score (0.0-1.0)",
          "minimum": 0,
          "maximum": 1,
          "default": 0.7
        },
        "semantic_search": {
          "type": "boolean",
          "description": "Enable semantic search algorithms",
          "default": true
        },
        "fuzzy_matching": {
          "type": "boolean",
          "description": "Enable fuzzy string matching",
          "default": false
        },
        "case_sensitive": {
          "type": "boolean",
          "description": "Enable case-sensitive matching",
          "default": false
        }
      }
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Query analysis timestamp"
    },
    "metadata": {
      "type": "object",
      "description": "Additional query metadata",
      "properties": {
        "user_id": {
          "type": "string"
        },
        "session_id": {
          "type": "string"
        },
        "context": {
          "type": "string",
          "description": "Additional context provided by user"
        }
      }
    }
  },
  "additionalProperties": false
}
