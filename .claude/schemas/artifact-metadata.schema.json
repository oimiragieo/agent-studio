{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Artifact Metadata",
  "description": "Shared metadata schema for cross-platform artifact publishing synchronization",
  "required": ["id", "type", "created", "workflow_id", "step_number", "agent"],
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique artifact identifier",
      "pattern": "^artifact-[a-zA-Z0-9_-]+$"
    },
    "type": {
      "type": "string",
      "enum": [
        "plan",
        "architecture",
        "specification",
        "implementation",
        "test-results",
        "documentation",
        "other"
      ],
      "description": "Artifact type"
    },
    "title": {
      "type": "string",
      "description": "Human-readable artifact title"
    },
    "created": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when artifact was created"
    },
    "workflow_id": {
      "type": "string",
      "description": "Workflow identifier that produced this artifact"
    },
    "step_number": {
      "type": "integer",
      "minimum": 0,
      "description": "Step number that produced this artifact"
    },
    "agent": {
      "type": "string",
      "description": "Agent that produced this artifact"
    },
    "dependencies": {
      "type": "array",
      "description": "List of artifact IDs this artifact depends on",
      "items": {
        "type": "string"
      },
      "default": []
    },
    "validation_status": {
      "type": "string",
      "enum": ["pass", "fail", "pending"],
      "description": "Validation status of the artifact",
      "default": "pending"
    },
    "tags": {
      "type": "array",
      "description": "Tags for categorization",
      "items": {
        "type": "string"
      },
      "default": []
    },
    "publish_targets": {
      "type": "array",
      "description": "Target destinations for publishing (e.g., project_feed, cursor)",
      "items": {
        "type": "string",
        "enum": ["project_feed", "cursor"]
      },
      "default": []
    },
    "published": {
      "type": "boolean",
      "description": "Whether this artifact has been published",
      "default": false
    },
    "published_at": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "ISO 8601 timestamp when artifact was published"
    },
    "publish_status": {
      "type": "string",
      "enum": ["pending", "success", "failed"],
      "description": "Current publishing status",
      "default": "pending"
    },
    "publish_error": {
      "type": ["string", "null"],
      "description": "Error message if publishing failed"
    },
    "publish_attempts": {
      "type": "array",
      "description": "History of publish attempts for retry tracking",
      "items": {
        "type": "object",
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "status": {
            "type": "string",
            "enum": ["success", "failed"]
          },
          "error": {
            "type": ["string", "null"]
          },
          "target": {
            "type": "string"
          }
        },
        "required": ["timestamp", "status", "target"]
      },
      "default": []
    },
    "platform": {
      "type": "string",
      "enum": ["claude", "cursor"],
      "description": "Platform where artifact was created"
    },
    "last_synced": {
      "type": ["string", "null"],
      "format": "date-time",
      "description": "ISO 8601 timestamp when metadata was last synced across platforms"
    }
  }
}
