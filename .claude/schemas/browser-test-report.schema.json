{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Browser Test Report",
  "description": "Schema for comprehensive browser testing reports that consolidate all findings from UI testing, log analysis, performance measurement, and optimization analysis",
  "required": ["report_id", "report_date", "tester_agent", "target_url", "summary"],
  "properties": {
    "report_id": {
      "type": "string",
      "description": "Unique identifier for the browser test report"
    },
    "report_date": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the report was generated"
    },
    "tester_agent": {
      "type": "string",
      "description": "Agent that generated the report (e.g., developer)"
    },
    "target_url": {
      "type": "string",
      "format": "uri",
      "description": "URL of the application tested"
    },
    "browser_info": {
      "type": "object",
      "properties": {
        "browser": {
          "type": "string",
          "description": "Browser used (e.g., Chrome, Firefox)"
        },
        "version": {
          "type": "string",
          "description": "Browser version"
        },
        "user_agent": {
          "type": "string",
          "description": "User agent string"
        }
      }
    },
    "summary": {
      "type": "object",
      "required": [
        "total_features_tested",
        "bugs_found_count",
        "performance_issues_count",
        "documentation_discrepancies_count"
      ],
      "properties": {
        "total_features_tested": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of UI features tested"
        },
        "features_passed": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of features that passed testing"
        },
        "features_failed": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of features that failed testing"
        },
        "features_warning": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of features with warnings"
        },
        "bugs_found_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of bugs found"
        },
        "critical_bugs": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of critical bugs"
        },
        "high_priority_bugs": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of high priority bugs"
        },
        "performance_issues_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of performance issues identified"
        },
        "documentation_discrepancies_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of documentation discrepancies found"
        },
        "optimization_opportunities_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of optimization opportunities identified"
        },
        "test_duration_minutes": {
          "type": "number",
          "minimum": 0,
          "description": "Total testing duration in minutes"
        }
      }
    },
    "browser_session": {
      "type": "object",
      "description": "Reference to browser session data",
      "properties": {
        "session_id": {
          "type": "string",
          "description": "Reference to browser-session-{{workflow_id}}.json"
        },
        "screenshots_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of screenshots captured"
        },
        "pages_tested": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of pages/URLs tested"
        }
      }
    },
    "ui_test_results": {
      "type": "string",
      "description": "Reference to ui-test-results-{{workflow_id}}.json artifact"
    },
    "log_analysis": {
      "type": "string",
      "description": "Reference to log-analysis-{{workflow_id}}.json artifact"
    },
    "performance_metrics": {
      "type": "string",
      "description": "Reference to performance-metrics-{{workflow_id}}.json artifact"
    },
    "documentation_comparison": {
      "type": "string",
      "description": "Reference to documentation-comparison-{{workflow_id}}.json artifact"
    },
    "bugs_found": {
      "type": "array",
      "description": "Array of bugs found during testing",
      "items": {
        "type": "object",
        "required": ["bug_id", "title", "severity", "priority", "location"],
        "properties": {
          "bug_id": {
            "type": "string",
            "description": "Unique identifier for the bug"
          },
          "title": {
            "type": "string",
            "description": "Short title of the bug"
          },
          "description": {
            "type": "string",
            "description": "Detailed description of the bug"
          },
          "severity": {
            "type": "string",
            "enum": ["critical", "high", "medium", "low"],
            "description": "Severity level of the bug"
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"],
            "description": "Priority level (P0 = critical, P3 = low)"
          },
          "location": {
            "type": "string",
            "description": "Where the bug occurs (URL, component, file path)"
          },
          "feature_affected": {
            "type": "string",
            "description": "Feature or component affected by the bug"
          },
          "steps_to_reproduce": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Steps to reproduce the bug"
          },
          "expected_behavior": {
            "type": "string",
            "description": "Expected behavior"
          },
          "actual_behavior": {
            "type": "string",
            "description": "Actual behavior observed"
          },
          "screenshots": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Paths to screenshots showing the bug"
          },
          "console_errors": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Console errors related to this bug"
          },
          "estimated_effort": {
            "type": "string",
            "description": "Estimated effort to fix (e.g., '2-4 hours', '1 day')"
          }
        }
      }
    },
    "optimization_opportunities": {
      "type": "object",
      "description": "UI and performance optimization opportunities",
      "properties": {
        "ui_ux_improvements": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["improvement", "priority"],
            "properties": {
              "improvement": {
                "type": "string",
                "description": "Description of the UI/UX improvement"
              },
              "priority": {
                "type": "string",
                "enum": ["P0", "P1", "P2", "P3"],
                "description": "Priority of the improvement"
              },
              "category": {
                "type": "string",
                "enum": [
                  "accessibility",
                  "visual_design",
                  "interaction",
                  "layout",
                  "responsive",
                  "other"
                ],
                "description": "Category of the improvement"
              },
              "estimated_effort": {
                "type": "string",
                "description": "Estimated effort to implement"
              },
              "impact": {
                "type": "string",
                "enum": ["low", "medium", "high"],
                "description": "Expected impact of the improvement"
              }
            }
          }
        },
        "performance_optimizations": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["optimization", "priority"],
            "properties": {
              "optimization": {
                "type": "string",
                "description": "Description of the performance optimization"
              },
              "priority": {
                "type": "string",
                "enum": ["P0", "P1", "P2", "P3"],
                "description": "Priority of the optimization"
              },
              "category": {
                "type": "string",
                "enum": [
                  "code_splitting",
                  "image_optimization",
                  "lazy_loading",
                  "caching",
                  "api_optimization",
                  "bundle_size",
                  "render_optimization",
                  "other"
                ],
                "description": "Category of the optimization"
              },
              "estimated_improvement": {
                "type": "string",
                "description": "Expected performance improvement (e.g., '40% bundle reduction', '200ms faster load')"
              },
              "estimated_effort": {
                "type": "string",
                "description": "Estimated effort to implement"
              }
            }
          }
        }
      }
    },
    "recommendations": {
      "type": "array",
      "description": "Prioritized action items and recommendations",
      "items": {
        "type": "object",
        "required": ["action", "priority", "category"],
        "properties": {
          "action": {
            "type": "string",
            "description": "Recommended action to take"
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"],
            "description": "Priority level (P0 = critical, P3 = low)"
          },
          "category": {
            "type": "string",
            "enum": [
              "bug_fix",
              "performance",
              "ui_ux",
              "documentation",
              "accessibility",
              "security",
              "other"
            ],
            "description": "Category of the recommendation"
          },
          "estimated_effort": {
            "type": "string",
            "description": "Estimated effort to complete the action"
          },
          "rationale": {
            "type": "string",
            "description": "Reasoning for this recommendation"
          },
          "related_bugs": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Bug IDs related to this recommendation"
          },
          "phase": {
            "type": "integer",
            "minimum": 1,
            "description": "Suggested implementation phase number"
          }
        }
      }
    },
    "implementation_phases": {
      "type": "array",
      "description": "Phased implementation plan",
      "items": {
        "type": "object",
        "required": ["phase_number", "phase_name", "priority"],
        "properties": {
          "phase_number": {
            "type": "integer",
            "minimum": 1,
            "description": "Phase number"
          },
          "phase_name": {
            "type": "string",
            "description": "Name of the phase (e.g., 'Critical Fixes', 'High Priority')"
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"],
            "description": "Priority level for this phase"
          },
          "items": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of bugs/optimizations in this phase"
          },
          "estimated_time": {
            "type": "string",
            "description": "Estimated time to complete this phase"
          },
          "estimated_effort_hours": {
            "type": "number",
            "minimum": 0,
            "description": "Estimated effort in hours"
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "testing_tools_used": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tools used for testing (e.g., Chrome DevTools MCP, Playwright)"
        },
        "documentation_sources": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Documentation sources referenced (e.g., PRD, UX spec, user stories)"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or context about the testing"
        }
      }
    }
  }
}
