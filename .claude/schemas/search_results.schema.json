{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://llm-rules.dev/schemas/search_results.schema.json",
  "title": "Search Results Schema",
  "description": "Schema for search results with matched documents, relevance scores, and metadata",
  "type": "object",
  "required": ["query", "results", "metadata", "timestamp"],
  "properties": {
    "query": {
      "type": "string",
      "description": "Original search query",
      "minLength": 1
    },
    "results": {
      "type": "array",
      "description": "Search results matching the query",
      "items": {
        "type": "object",
        "required": ["id", "title", "relevance_score", "snippet"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique document identifier"
          },
          "title": {
            "type": "string",
            "description": "Document title or filename"
          },
          "relevance_score": {
            "type": "number",
            "description": "Relevance score (0.0-1.0)",
            "minimum": 0,
            "maximum": 1
          },
          "snippet": {
            "type": "string",
            "description": "Code snippet or text excerpt with context"
          },
          "file_path": {
            "type": "string",
            "description": "Full file path to the document"
          },
          "line_number": {
            "type": "integer",
            "description": "Line number where match was found",
            "minimum": 1
          },
          "context": {
            "type": "object",
            "description": "Additional context lines around the match",
            "properties": {
              "before": {
                "type": "array",
                "description": "Lines before the match",
                "items": {
                  "type": "string"
                },
                "maxItems": 5
              },
              "after": {
                "type": "array",
                "description": "Lines after the match",
                "items": {
                  "type": "string"
                },
                "maxItems": 5
              }
            }
          },
          "matched_keywords": {
            "type": "array",
            "description": "Keywords that matched in this result",
            "items": {
              "type": "string"
            }
          },
          "category": {
            "type": "string",
            "description": "Document category (e.g., 'documentation', 'code', 'config')"
          },
          "url": {
            "type": "string",
            "format": "uri",
            "description": "URL to full document (if applicable)"
          },
          "last_modified": {
            "type": "string",
            "format": "date-time",
            "description": "Last modification timestamp"
          }
        },
        "additionalProperties": false
      }
    },
    "metadata": {
      "type": "object",
      "description": "Search execution metadata",
      "required": ["total_results", "execution_time_ms", "result_count"],
      "properties": {
        "total_results": {
          "type": "integer",
          "description": "Total number of matching results",
          "minimum": 0
        },
        "result_count": {
          "type": "integer",
          "description": "Number of results returned in this response",
          "minimum": 0
        },
        "execution_time_ms": {
          "type": "integer",
          "description": "Query execution time in milliseconds",
          "minimum": 0
        },
        "index_statistics": {
          "type": "object",
          "description": "Search index statistics",
          "properties": {
            "total_documents": {
              "type": "integer",
              "minimum": 0
            },
            "last_index_update": {
              "type": "string",
              "format": "date-time"
            },
            "index_version": {
              "type": "string"
            }
          }
        },
        "query_parameters": {
          "type": "object",
          "description": "Parameters used for this search",
          "properties": {
            "relevance_threshold": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "max_results": {
              "type": "integer",
              "minimum": 1
            },
            "filters_applied": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        },
        "performance_metrics": {
          "type": "object",
          "description": "Performance metrics for this query",
          "properties": {
            "cache_hit": {
              "type": "boolean",
              "description": "Whether results were served from cache"
            },
            "latency_percentile_95": {
              "type": "integer",
              "description": "95th percentile latency in milliseconds"
            },
            "api_rate_limit_remaining": {
              "type": "integer",
              "description": "Remaining API calls in current rate limit window"
            }
          }
        }
      },
      "additionalProperties": false
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "Search execution timestamp"
    },
    "refinement_suggestions": {
      "type": "array",
      "description": "Suggestions for refining the search query",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["broader", "narrower", "alternative", "filter"]
          },
          "suggestion": {
            "type": "string",
            "description": "Suggested refinement text"
          }
        }
      }
    },
    "errors": {
      "type": "array",
      "description": "Any errors encountered during search",
      "items": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Error code (e.g., 'RATE_LIMIT_EXCEEDED')"
          },
          "message": {
            "type": "string",
            "description": "Human-readable error message"
          },
          "severity": {
            "type": "string",
            "enum": ["warning", "error", "critical"]
          }
        }
      }
    }
  },
  "additionalProperties": false
}
