{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Cloud Integration",
  "description": "Schema for cloud service integration artifacts",
  "required": ["cloud_provider", "services", "authentication"],
  "properties": {
    "cloud_provider": {
      "type": "string",
      "enum": ["gcp", "aws", "azure"],
      "description": "Cloud provider for integration"
    },
    "services": {
      "type": "array",
      "description": "Cloud services integrated",
      "items": {
        "type": "object",
        "properties": {
          "service_name": {
            "type": "string",
            "description": "Name of cloud service (e.g., storage, pubsub, database)"
          },
          "service_type": {
            "type": "string",
            "description": "Type of service (e.g., gcs-bucket, pubsub-topic, cloud-sql)"
          },
          "module_path": {
            "type": "string",
            "description": "Path to service module file"
          },
          "client_library": {
            "type": "string",
            "description": "Client library used (e.g., @google-cloud/storage)"
          },
          "resource_name": {
            "type": "string",
            "description": "Concrete resource name from infrastructure-config.json"
          },
          "operations": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Operations implemented (e.g., upload, download, publish)"
          }
        },
        "required": ["service_name", "module_path", "client_library"]
      }
    },
    "authentication": {
      "type": "object",
      "description": "Authentication configuration",
      "properties": {
        "method": {
          "type": "string",
          "enum": ["adc", "service_account", "iam_role", "connection_string"],
          "description": "Authentication method used"
        },
        "service_account": {
          "type": "string",
          "description": "Service account name (if using service account)"
        },
        "iam_roles": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "IAM roles required"
        },
        "environment_variables": {
          "type": "object",
          "description": "Environment variables for authentication",
          "additionalProperties": {
            "type": "string"
          }
        }
      },
      "required": ["method"]
    },
    "error_handling": {
      "type": "object",
      "description": "Error handling strategies",
      "properties": {
        "retry_logic": {
          "type": "boolean",
          "description": "Whether retry logic is implemented"
        },
        "retry_config": {
          "type": "object",
          "properties": {
            "max_retries": {
              "type": "number"
            },
            "backoff_strategy": {
              "type": "string",
              "enum": ["exponential", "linear", "fixed"]
            }
          }
        },
        "error_types": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Error types handled (e.g., PERMISSION_DENIED, NOT_FOUND)"
        }
      }
    },
    "emulator_support": {
      "type": "object",
      "description": "Local emulator configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Whether emulator support is implemented"
        },
        "emulator_endpoints": {
          "type": "object",
          "description": "Emulator endpoint environment variables",
          "additionalProperties": {
            "type": "string"
          }
        },
        "test_config": {
          "type": "object",
          "description": "Test configuration for emulators"
        }
      }
    },
    "code_artifacts": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Paths to cloud integration code files created"
    },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "NPM packages or dependencies required"
    }
  }
}

