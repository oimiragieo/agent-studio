{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Incident Triage Assessment",
  "description": "Schema for incident triage assessment artifacts generated by incident-responder agent",
  "required": [
    "triage_id",
    "triage_date",
    "severity",
    "affected_systems",
    "immediate_actions",
    "status"
  ],
  "properties": {
    "triage_id": {
      "type": "string",
      "description": "Unique identifier for the triage assessment"
    },
    "triage_date": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when triage was performed"
    },
    "responder": {
      "type": "string",
      "description": "Agent or user who performed the triage"
    },
    "severity": {
      "type": "string",
      "enum": ["critical", "high", "medium", "low"],
      "description": "Incident severity classification"
    },
    "status": {
      "type": "string",
      "enum": ["investigating", "identified", "monitoring", "resolved", "escalated"],
      "description": "Current incident status"
    },
    "affected_systems": {
      "type": "array",
      "description": "List of affected systems and services",
      "items": {
        "type": "object",
        "required": ["name", "impact_level"],
        "properties": {
          "name": {
            "type": "string",
            "description": "System or service name"
          },
          "impact_level": {
            "type": "string",
            "enum": ["complete_outage", "degraded", "partial", "minimal"],
            "description": "Impact level on this system"
          },
          "description": {
            "type": "string",
            "description": "Description of how this system is affected"
          }
        }
      }
    },
    "affected_users": {
      "type": "object",
      "properties": {
        "count": {
          "type": "integer",
          "minimum": 0,
          "description": "Estimated number of affected users"
        },
        "percentage": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Percentage of user base affected"
        },
        "user_segments": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Affected user segments (e.g., 'enterprise', 'free tier')"
        }
      }
    },
    "impact_assessment": {
      "type": "object",
      "properties": {
        "business_impact": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"],
          "description": "Business impact level"
        },
        "revenue_impact": {
          "type": "boolean",
          "description": "Whether revenue is directly impacted"
        },
        "reputation_risk": {
          "type": "string",
          "enum": ["high", "medium", "low"],
          "description": "Risk to company reputation"
        },
        "sla_breach": {
          "type": "boolean",
          "description": "Whether SLA is breached or at risk"
        }
      }
    },
    "initial_hypothesis": {
      "type": "object",
      "properties": {
        "probable_cause": {
          "type": "string",
          "description": "Initial hypothesis for the root cause"
        },
        "confidence": {
          "type": "string",
          "enum": ["high", "medium", "low"],
          "description": "Confidence level in the hypothesis"
        },
        "supporting_evidence": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Evidence supporting the hypothesis"
        }
      }
    },
    "immediate_actions": {
      "type": "array",
      "description": "Immediate mitigation actions to take",
      "items": {
        "type": "object",
        "required": ["action", "priority"],
        "properties": {
          "action": {
            "type": "string",
            "description": "Action to take"
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"],
            "description": "Priority of the action"
          },
          "owner": {
            "type": "string",
            "description": "Person or team responsible"
          },
          "status": {
            "type": "string",
            "enum": ["pending", "in_progress", "completed", "blocked"],
            "description": "Status of the action"
          },
          "estimated_time": {
            "type": "string",
            "description": "Estimated time to complete"
          }
        }
      }
    },
    "communication_plan": {
      "type": "object",
      "properties": {
        "stakeholders": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Stakeholders to notify"
        },
        "status_page_update": {
          "type": "boolean",
          "description": "Whether status page should be updated"
        },
        "customer_notification": {
          "type": "boolean",
          "description": "Whether customers should be notified"
        },
        "internal_channels": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Internal communication channels (e.g., Slack, email)"
        }
      }
    },
    "timeline": {
      "type": "array",
      "description": "Timeline of incident events",
      "items": {
        "type": "object",
        "required": ["timestamp", "event"],
        "properties": {
          "timestamp": {
            "type": "string",
            "format": "date-time"
          },
          "event": {
            "type": "string"
          },
          "source": {
            "type": "string"
          }
        }
      }
    },
    "escalation_path": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "level": {
            "type": "integer"
          },
          "team": {
            "type": "string"
          },
          "contact": {
            "type": "string"
          },
          "triggered": {
            "type": "boolean"
          }
        }
      }
    }
  }
}
