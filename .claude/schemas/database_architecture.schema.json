{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Database Architecture",
  "description": "Schema for database architecture artifacts generated by Database Architect agent",
  "required": ["database_name", "database_type", "schema_design", "data_model"],
  "properties": {
    "database_name": {
      "type": "string",
      "description": "Name of the database"
    },
    "database_type": {
      "type": "string",
      "enum": ["relational", "nosql", "document", "key-value", "graph", "time-series", "columnar"],
      "description": "Type of database system"
    },
    "database_engine": {
      "type": "string",
      "description": "Specific database engine (e.g., PostgreSQL, MongoDB, Redis)"
    },
    "schema_design": {
      "type": "object",
      "description": "Database schema structure",
      "properties": {
        "tables": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string"
              },
              "columns": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "type": {
                      "type": "string"
                    },
                    "constraints": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "required": ["name", "type"]
                }
              },
              "indexes": {
                "type": "array",
                "items": {
                  "type": "object"
                }
              },
              "relationships": {
                "type": "array",
                "items": {
                  "type": "object"
                }
              }
            },
            "required": ["name"]
          }
        },
        "collections": {
          "type": "array",
          "items": {
            "type": "object",
            "description": "For NoSQL/document databases"
          }
        }
      }
    },
    "data_model": {
      "type": "object",
      "description": "Data modeling approach and patterns",
      "properties": {
        "normalization_level": {
          "type": "string",
          "enum": ["1NF", "2NF", "3NF", "BCNF", "denormalized"],
          "description": "Normalization level for relational databases"
        },
        "modeling_patterns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Data modeling patterns used (e.g., star schema, snowflake, document embedding)"
        }
      }
    },
    "relationships": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "from": {
            "type": "string"
          },
          "to": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "enum": ["one-to-one", "one-to-many", "many-to-many"]
          },
          "description": {
            "type": "string"
          }
        },
        "required": ["from", "to", "type"]
      },
      "description": "Relationships between database entities"
    },
    "indexing_strategy": {
      "type": "object",
      "properties": {
        "primary_indexes": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "secondary_indexes": {
          "type": "array",
          "items": {
            "type": "object"
          }
        },
        "indexing_rationale": {
          "type": "string",
          "description": "Explanation of indexing decisions"
        }
      }
    },
    "query_optimization": {
      "type": "object",
      "properties": {
        "optimization_strategies": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "query_patterns": {
          "type": "array",
          "items": {
            "type": "object"
          }
        }
      }
    },
    "migration_strategy": {
      "type": "object",
      "properties": {
        "migration_approach": {
          "type": "string",
          "enum": ["versioned", "state-based", "change-based"]
        },
        "rollback_plan": {
          "type": "string"
        },
        "migration_tools": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "data_retention": {
      "type": "object",
      "properties": {
        "retention_policy": {
          "type": "string"
        },
        "archival_strategy": {
          "type": "string"
        }
      }
    },
    "backup_strategy": {
      "type": "object",
      "properties": {
        "backup_frequency": {
          "type": "string"
        },
        "backup_type": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "recovery_point_objective": {
          "type": "string"
        },
        "recovery_time_objective": {
          "type": "string"
        }
      }
    },
    "replication_strategy": {
      "type": "object",
      "properties": {
        "replication_type": {
          "type": "string",
          "enum": ["master-slave", "master-master", "multi-master", "sharding", "none"]
        },
        "replication_factor": {
          "type": "number"
        },
        "consistency_model": {
          "type": "string",
          "enum": ["strong", "eventual", "causal", "session"]
        }
      }
    },
    "scalability_plan": {
      "type": "object",
      "properties": {
        "scaling_strategy": {
          "type": "string",
          "enum": ["vertical", "horizontal", "sharding", "partitioning"]
        },
        "capacity_planning": {
          "type": "string"
        }
      }
    },
    "security_considerations": {
      "type": "object",
      "properties": {
        "encryption": {
          "type": "object",
          "properties": {
            "at_rest": {
              "type": "boolean"
            },
            "in_transit": {
              "type": "boolean"
            }
          }
        },
        "access_control": {
          "type": "string"
        },
        "data_classification": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "performance_targets": {
      "type": "object",
      "properties": {
        "query_latency": {
          "type": "string"
        },
        "throughput": {
          "type": "string"
        },
        "concurrent_connections": {
          "type": "number"
        }
      }
    }
  }
}

