{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://claude-code.anthropic.com/schemas/test-results",
  "type": "object",
  "title": "Test Results",
  "description": "Schema for test results artifacts generated by QA agent",
  "required": ["results_id", "test_date", "overall_status", "test_summary"],
  "properties": {
    "results_id": {
      "type": "string",
      "description": "Unique identifier for the test results"
    },
    "test_date": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when tests were executed"
    },
    "test_executor": {
      "type": "string",
      "description": "QA agent or user who executed the tests"
    },
    "overall_status": {
      "type": "string",
      "enum": ["passed", "failed", "partial", "blocked"],
      "description": "Overall test execution status"
    },
    "test_summary": {
      "type": "object",
      "required": ["total_tests", "passed", "failed", "skipped"],
      "properties": {
        "total_tests": {
          "type": "integer",
          "minimum": 0
        },
        "passed": {
          "type": "integer",
          "minimum": 0
        },
        "failed": {
          "type": "integer",
          "minimum": 0
        },
        "skipped": {
          "type": "integer",
          "minimum": 0
        },
        "pass_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Percentage of tests passed"
        }
      }
    },
    "test_results_by_level": {
      "type": "object",
      "properties": {
        "unit": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 0
            },
            "passed": {
              "type": "integer",
              "minimum": 0
            },
            "failed": {
              "type": "integer",
              "minimum": 0
            },
            "skipped": {
              "type": "integer",
              "minimum": 0
            }
          }
        },
        "integration": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 0
            },
            "passed": {
              "type": "integer",
              "minimum": 0
            },
            "failed": {
              "type": "integer",
              "minimum": 0
            },
            "skipped": {
              "type": "integer",
              "minimum": 0
            }
          }
        },
        "e2e": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 0
            },
            "passed": {
              "type": "integer",
              "minimum": 0
            },
            "failed": {
              "type": "integer",
              "minimum": 0
            },
            "skipped": {
              "type": "integer",
              "minimum": 0
            }
          }
        },
        "manual": {
          "type": "object",
          "properties": {
            "total": {
              "type": "integer",
              "minimum": 0
            },
            "passed": {
              "type": "integer",
              "minimum": 0
            },
            "failed": {
              "type": "integer",
              "minimum": 0
            },
            "skipped": {
              "type": "integer",
              "minimum": 0
            }
          }
        }
      }
    },
    "test_executions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["test_id", "test_name", "status"],
        "properties": {
          "test_id": {
            "type": "string"
          },
          "test_name": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["passed", "failed", "skipped", "blocked"]
          },
          "test_level": {
            "type": "string",
            "enum": ["unit", "integration", "e2e", "manual"]
          },
          "duration_ms": {
            "type": "number",
            "minimum": 0
          },
          "error_message": {
            "type": "string"
          },
          "stack_trace": {
            "type": "string"
          },
          "test_scenario": {
            "type": "object",
            "properties": {
              "given": {
                "type": "string"
              },
              "when": {
                "type": "string"
              },
              "then": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "failed_tests": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["test_id", "test_name", "error_message"],
        "properties": {
          "test_id": {
            "type": "string"
          },
          "test_name": {
            "type": "string"
          },
          "error_message": {
            "type": "string"
          },
          "stack_trace": {
            "type": "string"
          },
          "test_level": {
            "type": "string",
            "enum": ["unit", "integration", "e2e", "manual"]
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"]
          }
        }
      }
    },
    "test_coverage": {
      "type": "object",
      "properties": {
        "statements": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "branches": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "functions": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "lines": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        }
      }
    },
    "performance_metrics": {
      "type": "object",
      "properties": {
        "average_response_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "p95_response_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "p99_response_time_ms": {
          "type": "number",
          "minimum": 0
        },
        "throughput": {
          "type": "number",
          "minimum": 0
        }
      }
    },
    "regression_analysis": {
      "type": "object",
      "properties": {
        "regression_tests_passed": {
          "type": "boolean"
        },
        "regression_issues_count": {
          "type": "integer",
          "minimum": 0
        },
        "regression_issues": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "description": {
                "type": "string"
              },
              "severity": {
                "type": "string",
                "enum": ["low", "medium", "high", "critical"]
              }
            }
          }
        }
      }
    },
    "recommendations": {
      "type": "array",
      "items": {
        "type": "string"
      }
    }
  }
}
