{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Recovery Performance Metrics",
  "type": "object",
  "required": ["metrics_id", "timestamp", "recovery_scenarios"],
  "properties": {
    "metrics_id": {
      "type": "string",
      "description": "Unique identifier for this metrics collection"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "When these metrics were collected"
    },
    "collection_period": {
      "type": "object",
      "properties": {
        "start": {
          "type": "string",
          "format": "date-time"
        },
        "end": {
          "type": "string",
          "format": "date-time"
        }
      }
    },
    "recovery_scenarios": {
      "type": "array",
      "description": "Performance metrics for different recovery scenarios",
      "items": {
        "type": "object",
        "required": ["scenario", "total_recoveries", "success_rate"],
        "properties": {
          "scenario": {
            "type": "string",
            "description": "Type of recovery scenario (e.g., 'checkpoint_restoration', 'agent_fallback')"
          },
          "total_recoveries": {
            "type": "integer",
            "description": "Total number of recovery attempts"
          },
          "successful_recoveries": {
            "type": "integer",
            "description": "Number of successful recoveries"
          },
          "failed_recoveries": {
            "type": "integer",
            "description": "Number of failed recoveries"
          },
          "success_rate": {
            "type": "number",
            "minimum": 0,
            "maximum": 100,
            "description": "Success rate as percentage"
          },
          "average_duration_ms": {
            "type": "integer",
            "description": "Average recovery time in milliseconds"
          },
          "min_duration_ms": {
            "type": "integer",
            "description": "Fastest recovery time"
          },
          "max_duration_ms": {
            "type": "integer",
            "description": "Slowest recovery time"
          },
          "percentile_50_ms": {
            "type": "integer",
            "description": "50th percentile (median) recovery time"
          },
          "percentile_95_ms": {
            "type": "integer",
            "description": "95th percentile recovery time"
          },
          "percentile_99_ms": {
            "type": "integer",
            "description": "99th percentile recovery time"
          }
        }
      }
    },
    "checkpoint_metrics": {
      "type": "object",
      "properties": {
        "total_checkpoints_created": {
          "type": "integer"
        },
        "total_checkpoints_restored": {
          "type": "integer"
        },
        "average_checkpoint_size_bytes": {
          "type": "integer"
        },
        "average_restoration_time_ms": {
          "type": "integer"
        }
      }
    },
    "fallback_metrics": {
      "type": "object",
      "properties": {
        "total_fallbacks_triggered": {
          "type": "integer"
        },
        "fallback_success_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "average_fallback_levels": {
          "type": "number",
          "description": "Average number of fallback levels tried before success"
        },
        "most_common_fallback_agent": {
          "type": "string"
        }
      }
    },
    "error_patterns": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "error_type": {
            "type": "string"
          },
          "count": {
            "type": "integer"
          },
          "recovery_success_rate": {
            "type": "number",
            "minimum": 0,
            "maximum": 100
          }
        }
      }
    },
    "overall_metrics": {
      "type": "object",
      "properties": {
        "total_recovery_attempts": {
          "type": "integer"
        },
        "overall_success_rate": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "average_recovery_time_ms": {
          "type": "integer"
        },
        "total_downtime_ms": {
          "type": "integer"
        }
      }
    }
  }
}
