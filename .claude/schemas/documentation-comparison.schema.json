{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Documentation Comparison",
  "description": "Schema for comparing actual application behavior with documented behavior",
  "required": ["comparison_id", "comparison_date", "documentation_sources", "discrepancies"],
  "properties": {
    "comparison_id": {
      "type": "string",
      "description": "Unique identifier for the comparison"
    },
    "comparison_date": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when comparison was performed"
    },
    "comparer_agent": {
      "type": "string",
      "description": "Agent that performed the comparison (e.g., qa)"
    },
    "documentation_sources": {
      "type": "array",
      "description": "Documentation sources referenced",
      "items": {
        "type": "object",
        "required": ["source_type", "source_path"],
        "properties": {
          "source_type": {
            "type": "string",
            "enum": ["prd", "ux_spec", "user_story", "technical_docs", "api_docs", "other"],
            "description": "Type of documentation source"
          },
          "source_path": {
            "type": "string",
            "description": "Path or reference to the documentation"
          },
          "source_name": {
            "type": "string",
            "description": "Name or title of the documentation"
          }
        }
      }
    },
    "discrepancies": {
      "type": "array",
      "description": "Array of discrepancies found between documentation and actual behavior",
      "items": {
        "type": "object",
        "required": ["feature_name", "discrepancy_type", "severity", "documented_behavior", "actual_behavior"],
        "properties": {
          "feature_name": {
            "type": "string",
            "description": "Name of the feature with discrepancy"
          },
          "discrepancy_type": {
            "type": "string",
            "enum": ["missing_feature", "undocumented_feature", "behavior_mismatch", "incorrect_documentation"],
            "description": "Type of discrepancy"
          },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"],
            "description": "Severity of the discrepancy"
          },
          "location": {
            "type": "string",
            "description": "Where the feature is in the application (URL, component path)"
          },
          "documented_behavior": {
            "type": "string",
            "description": "What the documentation says the feature should do"
          },
          "actual_behavior": {
            "type": "string",
            "description": "What the feature actually does"
          },
          "documentation_reference": {
            "type": "string",
            "description": "Specific reference in documentation (section, page, user story ID)"
          },
          "impact": {
            "type": "string",
            "description": "Impact of this discrepancy on users or development"
          },
          "recommendation": {
            "type": "string",
            "enum": ["update_documentation", "implement_feature", "fix_implementation", "both"],
            "description": "Recommended action"
          }
        }
      }
    },
    "undocumented_features": {
      "type": "array",
      "description": "Features that exist in the application but are not documented",
      "items": {
        "type": "object",
        "required": ["feature_name", "location"],
        "properties": {
          "feature_name": {
            "type": "string",
            "description": "Name of the undocumented feature"
          },
          "location": {
            "type": "string",
            "description": "Where the feature is in the application"
          },
          "description": {
            "type": "string",
            "description": "Description of what the feature does"
          },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"],
            "description": "Severity of missing documentation"
          },
          "recommendation": {
            "type": "string",
            "description": "Recommendation for documenting this feature"
          }
        }
      }
    },
    "missing_features": {
      "type": "array",
      "description": "Features that are documented but not implemented in the application",
      "items": {
        "type": "object",
        "required": ["feature_name", "documentation_reference"],
        "properties": {
          "feature_name": {
            "type": "string",
            "description": "Name of the missing feature"
          },
          "documentation_reference": {
            "type": "string",
            "description": "Reference to where this feature is documented"
          },
          "description": {
            "type": "string",
            "description": "Description from documentation"
          },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"],
            "description": "Severity of missing feature"
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"],
            "description": "Priority for implementing this feature"
          },
          "estimated_effort": {
            "type": "string",
            "description": "Estimated effort to implement"
          }
        }
      }
    },
    "documentation_accuracy_score": {
      "type": "object",
      "description": "Overall documentation accuracy metrics",
      "properties": {
        "score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Documentation accuracy score (0-100)"
        },
        "calculation_method": {
          "type": "string",
          "description": "How the score was calculated"
        },
        "factors": {
          "type": "object",
          "properties": {
            "features_documented_correctly": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of features documented correctly"
            },
            "features_with_discrepancies": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of features with discrepancies"
            },
            "undocumented_features_count": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of undocumented features"
            },
            "missing_features_count": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of missing features"
            }
          }
        }
      }
    },
    "summary": {
      "type": "object",
      "properties": {
        "total_features_compared": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of features compared"
        },
        "discrepancies_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of discrepancies found"
        },
        "undocumented_features_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of undocumented features"
        },
        "missing_features_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of missing features"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "comparison_method": {
          "type": "string",
          "description": "Method used for comparison"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes about the comparison"
        }
      }
    }
  }
}

