{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Secret Reference",
  "description": "Schema for Secret Manager references. Ensures secrets are stored as references, never actual values, to prevent security vulnerabilities.",
  "required": ["secret_id", "environment_variable"],
  "properties": {
    "secret_id": {
      "type": "string",
      "pattern": "^projects/[^/]+/secrets/[^/]+/versions/[^/]+$",
      "description": "Full Secret Manager path (format: projects/{project_id}/secrets/{secret_name}/versions/{version}). Example: projects/my-proj/secrets/db-password/versions/1"
    },
    "environment_variable": {
      "type": "string",
      "description": "Environment variable name that should contain the secret_id (e.g., DB_PASSWORD_SECRET_ID). Application code should read this env var and use it to fetch the secret from Secret Manager at runtime.",
      "pattern": "^[A-Z][A-Z0-9_]*$",
      "examples": ["DB_PASSWORD_SECRET_ID", "API_KEY_SECRET_ID", "JWT_SECRET_ID"]
    },
    "local_development_note": {
      "type": "string",
      "description": "Instructions for local development (e.g., 'Set DB_PASSWORD in .env (never commit .env)'). Documents that local dev should use .env file, which must never be committed to git."
    },
    "secret_name": {
      "type": "string",
      "description": "Human-readable name of the secret (e.g., 'db-password', 'api-key')"
    },
    "secret_type": {
      "type": "string",
      "enum": ["password", "api_key", "token", "certificate", "connection_string", "other"],
      "description": "Type of secret for categorization"
    },
    "rotation_policy": {
      "type": "object",
      "description": "Secret rotation policy (optional)",
      "properties": {
        "rotation_interval_days": {
          "type": "integer",
          "minimum": 1,
          "description": "Number of days between secret rotations"
        },
        "auto_rotation": {
          "type": "boolean",
          "description": "Whether secret rotation is automated"
        }
      }
    }
  },
  "additionalProperties": false
}
