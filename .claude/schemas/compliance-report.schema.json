{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Compliance Report",
  "description": "Schema for compliance report artifacts generated by compliance-auditor agent",
  "required": ["report_id", "report_date", "overall_compliance_status", "standards_assessed"],
  "properties": {
    "report_id": {
      "type": "string",
      "description": "Unique identifier for the compliance report"
    },
    "report_date": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the report was generated"
    },
    "auditor": {
      "type": "string",
      "description": "Agent or user who performed the audit"
    },
    "overall_compliance_status": {
      "type": "string",
      "enum": ["compliant", "mostly_compliant", "non_compliant", "requires_review"],
      "description": "Overall compliance status"
    },
    "standards_assessed": {
      "type": "array",
      "description": "List of standards and frameworks assessed",
      "items": {
        "type": "string",
        "enum": ["OWASP", "GDPR", "HIPAA", "SOC2", "PCI-DSS", "ISO27001", "NIST", "CIS", "custom"]
      },
      "minItems": 1
    },
    "assessments": {
      "type": "array",
      "description": "Detailed assessments for each standard",
      "items": {
        "type": "object",
        "required": ["standard", "compliance_status", "findings"],
        "properties": {
          "standard": {
            "type": "string",
            "description": "Name of the standard or framework"
          },
          "compliance_status": {
            "type": "string",
            "enum": ["compliant", "mostly_compliant", "non_compliant", "not_applicable"],
            "description": "Compliance status for this standard"
          },
          "compliance_score": {
            "type": "number",
            "description": "Compliance score (0-100)",
            "minimum": 0,
            "maximum": 100
          },
          "findings": {
            "type": "array",
            "description": "Compliance findings for this standard",
            "items": {
              "type": "object",
              "required": ["type", "severity", "description"],
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["violation", "gap", "recommendation", "strength"],
                  "description": "Type of finding"
                },
                "severity": {
                  "type": "string",
                  "enum": ["low", "medium", "high", "critical"],
                  "description": "Severity of the finding"
                },
                "description": {
                  "type": "string",
                  "description": "Detailed description of the finding"
                },
                "requirement": {
                  "type": "string",
                  "description": "Specific requirement or control that was assessed"
                },
                "recommendation": {
                  "type": "string",
                  "description": "Recommended remediation action"
                },
                "location": {
                  "type": "string",
                  "description": "File path or component where the issue was found"
                }
              }
            }
          }
        }
      }
    },
    "coding_guidelines": {
      "type": "object",
      "description": "Assessment of coding guidelines compliance",
      "properties": {
        "adherence_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "violations": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "guideline": {
                "type": "string"
              },
              "violation_count": {
                "type": "integer",
                "minimum": 0
              },
              "examples": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "security_best_practices": {
      "type": "object",
      "description": "Assessment of security best practices",
      "properties": {
        "adherence_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "practices_assessed": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "practice": {
                "type": "string"
              },
              "compliant": {
                "type": "boolean"
              },
              "notes": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "documentation_requirements": {
      "type": "object",
      "description": "Assessment of documentation requirements",
      "properties": {
        "adherence_score": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "missing_documentation": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "documentation_quality": {
          "type": "string",
          "enum": ["excellent", "good", "adequate", "poor", "missing"]
        }
      }
    },
    "recommendations": {
      "type": "array",
      "description": "High-level recommendations for achieving compliance",
      "items": {
        "type": "string"
      }
    },
    "remediation_priority": {
      "type": "array",
      "description": "Prioritized list of remediation actions",
      "items": {
        "type": "object",
        "required": ["action", "priority"],
        "properties": {
          "action": {
            "type": "string",
            "description": "Description of the remediation action"
          },
          "priority": {
            "type": "string",
            "enum": ["P0", "P1", "P2", "P3"],
            "description": "Priority ranking (P0 = highest)"
          },
          "standard": {
            "type": "string",
            "description": "Standard this action addresses"
          },
          "estimated_effort": {
            "type": "string",
            "description": "Estimated effort to complete (e.g., '2 hours', '1 day')"
          }
        }
      }
    }
  }
}

