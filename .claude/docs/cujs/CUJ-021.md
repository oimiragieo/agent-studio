# CUJ-021: Mobile Development

## User Goal

Develop mobile application features.

## Trigger

- `/mobile`
- "Mobile development"
- "iOS/Android feature"

## Workflow

**Execution Mode**: `mobile-flow.yaml`

### Step 0: Planning Phase

- Planner creates mobile development plan
- Analyzes mobile requirements and platform choices
- Coordinates with Mobile Developer for mobile strategy
- Defines mobile architecture and platform approach
- Outputs: `plan-{{workflow_id}}.md`, `plan-{{workflow_id}}.json`

### Step 0.1: Plan Rating Gate

- Agent: orchestrator
- Type: validation
- Skill: response-rater
- Validates plan quality (minimum score: 7/10)
- Rubric: completeness, feasibility, risk mitigation, agent coverage, integration
- If score < 7: Return to Planner with feedback
- If score >= 7: Proceed to execution
- Records rating in `.claude/context/runtime/runs/<run_id>/plans/<plan_id>-rating.json`

### Step 1: Mobile Planning

- Mobile Developer plans strategy
- Chooses platform approach
- Designs mobile architecture

### Step 2: UX Design

- UX Expert designs mobile interface
- Creates mobile-specific flows
- Ensures accessibility

### Step 3: Implementation

- Developer implements mobile features
- Uses platform-specific patterns
- Tests on devices

### Step 4: Quality Validation

- QA tests on multiple devices
- Validates platform compatibility
- Ensures quality

### Step 4.5: Publish Artifacts

- **Agent**: orchestrator
- **Skill**: artifact-publisher
- **Condition**: `validation_status == 'pass'`
- **Policy**: auto-on-pass
- **Inputs**: All validated artifacts from workflow (mobile implementation, platform-specific code, device testing results, mobile documentation)
- **Outputs**: Published artifacts in project feed
- **Description**: Publish all validated mobile development artifacts to project feed for cross-platform visibility. Includes mobile feature implementations, platform-specific code, device compatibility test results, and mobile-specific documentation.

## Agents Used

- Mobile Developer → UX Expert → Developer → QA

## Capabilities/Tools Used

- Mobile-specific tools (platform-specific mobile development tools)

## Expected Outputs

- Mobile implementation
- Platform-specific code
- Device testing results
- Mobile documentation

## Success Criteria

| Criterion                       | Measurement                     | Target                                                                                    |
| ------------------------------- | ------------------------------- | ----------------------------------------------------------------------------------------- |
| Mobile features implemented     | Implementation complete         | Mobile features developed and functional                                                  |
| Plan rating                     | response-rater skill score      | >= 7/10 (recorded in `.claude/context/runtime/runs/<run_id>/plans/<plan_id>-rating.json`) |
| Rating recorded                 | Rating file exists in run state | File present at `.claude/context/runtime/runs/<run_id>/plans/<plan_id>-rating.json`       |
| Platform compatibility verified | Platform testing results        | Compatibility validated across target platforms                                           |
| Device testing passed           | Device test results             | Tests passing on multiple devices                                                         |
| Quality validated               | QA validation complete          | Quality standards met                                                                     |

## Example Prompts

```
/mobile
"Build mobile app for iOS"
"Create React Native feature"
```

## Error Recovery

### Retry Strategy

- **Max Retries**: 3 attempts per step
- **Backoff**: Exponential (1s, 2s, 4s)
- **Retry Triggers**: Transient failures, timeouts, rate limits

### Rollback Procedures

1. **Partial Completion**: Save checkpoint to `.claude/context/runtime/runs/{{run_id}}/checkpoint.json`
2. **Failed Validation**: Return to previous passing gate
3. **Critical Failure**: Escalate to human with full context

### Fallback Options

- **Alternative Agent**: If primary agent fails 3x, route to backup agent
  - Mobile-Developer → Developer (implementation fallback)
  - UX-Expert → Mobile-Developer (design fallback)
  - QA → Mobile-Developer (testing fallback)
- **Manual Override**: User can force-proceed with documented risks
- **Graceful Degradation**: Deploy with reduced platform support (e.g., iOS only) with warnings

### Recovery Artifacts

- Error log: `.claude/context/runtime/runs/{{run_id}}/errors.log`
- Recovery state: `.claude/context/runtime/runs/{{run_id}}/recovery-state.json`
- Checkpoint: `.claude/context/runtime/runs/{{run_id}}/checkpoint.json`
