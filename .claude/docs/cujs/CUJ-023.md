# CUJ-023: Dependency Updates

## User Goal
Safely update project dependencies.

## Trigger
- "Update dependencies safely"
- "Check for dependency updates"
- "Dependency management"

## Workflow

**Execution Mode**: `skill-only`

### Step 0: Planning Phase
- Planner creates dependency update plan
- Analyzes dependency update requirements and risks
- Coordinates with DevOps for update strategy
- Defines update phases and validation approach
- Outputs: `plan-{{workflow_id}}.md`, `plan-{{workflow_id}}.json`


### Step 0.1: Plan Rating Gate
- Agent: orchestrator
- Type: validation
- Skill: response-rater
- Validates plan quality (minimum score: 7/10)
- Rubric: completeness, feasibility, risk mitigation, agent coverage, integration
- If score < 7: Return to Planner with feedback
- If score >= 7: Proceed to execution
- Records rating in `.claude/context/runs/<run_id>/plans/<plan_id>-rating.json`

### Step 1: Dependency Analysis
- dependency-analyzer scans dependencies
- Identifies outdated packages
- Checks for vulnerabilities

### Step 2: Update Planning
- Analyzes breaking changes
- Creates update strategy
- Plans phased updates

### Step 3: Update Execution
- DevOps executes updates
- Tests compatibility
- Validates changes

### Step 4: Validation
- Runs tests
- Checks for regressions
- Validates functionality

## Agents Used
- DevOps

## Skills Used
- `dependency-analyzer` - Dependency analysis with semantic versioning and breaking change detection
- `dependency-analyzer` - Dependency analysis
- `response-rater` - Plan quality validation

## Expected Outputs
- Dependency report
- Update plan
- Updated dependencies
- Compatibility validation

## Success Criteria
- [ ] Dependencies analyzed (artifact: dependency-report.json)
- [ ] Plan rating >= 7/10 (recorded in `.claude/context/runs/<run_id>/plans/<plan_id>-rating.json`)
- [ ] Rating recorded in run state (validation: rating file exists)
- [ ] Updates planned (artifact: update-plan.json)
- [ ] Breaking changes identified (artifact: breaking-changes.json)
- [ ] Compatibility validated (artifact: compatibility-report.json, validated by gate file)

## Example Prompts
```
"Update dependencies safely"
"Check for security vulnerabilities"
"Plan dependency updates"
```

