# CUJ-028: Infrastructure-First Development

## User Goal
Define concrete infrastructure resources before implementation to prevent rework.

## Trigger
- "Build cloud-connected application"
- Greenfield project with cloud services
- Need for concrete resource names upfront

## Workflow

**Execution Mode**: `greenfield-fullstack.yaml`

### Step 4: System Architecture
- Architect creates logical architecture
- Identifies cloud services needed

### Step 4.5: Infrastructure Resource Definition (NEW)
- DevOps agent converts logical to concrete
- Generates resource names with unique suffixes
- Creates connection strings (with secret placeholders)
- Defines Secret Manager references
- Outputs infrastructure-config.json
- Security validation: no hardcoded secrets, all secrets use references, resource names have suffixes

### Step 5-7: Implementation with Concrete Resources
- Database Architect uses actual connection strings
- Developer uses concrete resource names
- Cloud-Integrator uses infrastructure-config.json

### Step 11: Infrastructure Provisioning
- GCP Cloud Agent provisions actual resources
- Uses infrastructure-config.json

## Agents Used
- Architect → DevOps (Step 4.5) → Database Architect → Developer → Cloud-Integrator → GCP Cloud Agent

## Skills Used
- Infrastructure-as-code generation
- Resource naming strategies
- Secret management

## Expected Outputs
- infrastructure-config.json (Step 4.5)
- terraform-plan.json (Step 4.5)
- deployment-config.json (Step 4.5)
- Code using concrete resource names (Step 7)

## Success Criteria
- ✅ Resource names defined before coding
- ✅ No rework needed when resources provisioned
- ✅ Connection strings use actual resource names
- ✅ Secrets properly referenced (never hardcoded)
- ✅ Infrastructure provisioned successfully
- ✅ Security validation passes

## Example Prompts
```
"Build a GCP application with storage and pubsub"
"Create cloud app with database and storage buckets"
```

## Related Documentation
- [greenfield-fullstack Workflow](../../workflows/greenfield-fullstack.yaml) - Step 4.5
- [WORKFLOW-GUIDE.md](../../workflows/WORKFLOW-GUIDE.md) - Infrastructure-First Approach
- [DevOps Agent](../../agents/devops.md) - Infrastructure Resource Definition Process

