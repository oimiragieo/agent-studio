# CUJ-018: Architecture Documentation

## User Goal
Document system architecture with diagrams.

## Trigger
- "Document system architecture"
- "Generate architecture docs"
- "Create architecture documentation"

## Workflow

**Execution Mode**: `workflow`

### Step 0: Planning Phase
- Planner creates documentation plan
- Analyzes architecture scope and documentation requirements
- Coordinates with Architect for architecture understanding
- Determines diagram types and documentation structure
- Outputs: `plan-{{workflow_id}}.md`, `plan-{{workflow_id}}.json`


### Step 0.1: Plan Rating Gate
- Agent: orchestrator
- Type: validation
- Skill: response-rater
- Validates plan quality (minimum score: 7/10)
- Rubric: completeness, feasibility, risk mitigation, agent coverage, integration
- If score < 7: Return to Planner with feedback
- If score >= 7: Proceed to execution
- Records rating in `.claude/context/runs/<run_id>/plans/<plan_id>-rating.json`

### Step 1: Architecture Analysis
- Architect analyzes system
- Identifies components and relationships
- Understands data flows

### Step 2: Diagram Generation
- diagram-generator creates diagrams
- Architecture diagrams
- Component diagrams
- Sequence diagrams

### Step 3: Documentation
- Technical Writer documents architecture
- Adds explanations
- Creates comprehensive guide

## Agents Used
- Architect â†’ Technical Writer

## Skills Used
- `diagram-generator` - Diagram creation
- `doc-generator` - Documentation
- `response-rater` - Plan quality validation

## Expected Outputs
- Architecture documentation
- Architecture diagrams
- Component diagrams
- ADR templates

## Success Criteria

| Criterion | Measurement | Target |
|-----------|-------------|--------|
| Architecture documented | Documentation artifact exists | Architecture documentation complete |
| Plan rating | response-rater skill score | >= 7/10 (recorded in `.claude/context/runs/<run_id>/plans/<plan_id>-rating.json`) |
| Rating recorded | Rating file exists in run state | File present at `.claude/context/runs/<run_id>/plans/<plan_id>-rating.json` |
| Diagrams generated | Diagram artifacts exist | Architecture, component, and sequence diagrams created |
| Documentation complete | Documentation validation | Comprehensive architecture guide created |
| ADRs created | ADR templates generated | Architecture Decision Records documented |

## Example Prompts
```
"Document the system architecture"
"Generate architecture diagrams"
"Create architecture decision records"
```

