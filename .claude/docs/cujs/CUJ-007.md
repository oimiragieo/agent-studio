# CUJ-007: Technical Debt Planning

## User Goal
Plan refactoring of legacy code and technical debt.

## Trigger
- "Plan refactoring of legacy code"
- "Technical debt planning"
- "Refactoring plan"

## Workflow

**Execution Mode**: `workflow`

### Step 1: Planning
- Planner creates refactoring plan
- Analyzes scope and impact

### Step 2: Code Analysis
- Refactoring Specialist analyzes code
- Identifies technical debt
- Assesses refactoring impact

### Step 3: Refactoring Plan
- Creates detailed refactoring plan
- Prioritizes debt items
- Defines migration strategy

### Step 4: Validation
- Validates plan feasibility
- Checks dependencies
- Estimates effort

## Agents Used
- Planner -> Refactoring Specialist

## Skills Used
- `plan-generator` - Refactoring plan

## Expected Outputs
- Refactoring plan
- Technical debt inventory
- Migration roadmap

## Success Criteria

| Criterion | Measurement | Target |
|-----------|-------------|--------|
| Plan created | Artifact validated by gate | `plan-{{workflow_id}}.json` validated by gate file |
| Technical debt inventory complete | Artifact debt_items field | Debt items array populated in `refactor-plan-{{workflow_id}}.json` |
| Debt items prioritized | Artifact priority field | Each item has priority: high\|medium\|low in `refactor-plan-{{workflow_id}}.json` |
| Effort estimates provided | Artifact effort_hours field | Each item has effort_hours field in `refactor-plan-{{workflow_id}}.json` |
| Dependencies mapped | Artifact dependencies field | Dependencies array populated in `refactor-plan-{{workflow_id}}.json` |
| Migration strategy defined | Artifact migration_strategy field | Migration strategy object populated in `refactor-plan-{{workflow_id}}.json` |
| Risk assessment complete | Artifact risks field | Risks array with probability and impact in `refactor-plan-{{workflow_id}}.json` |
| Report validated | Schema validation | Validated against `.claude/schemas/refactoring-plan.schema.json` |

## Example Prompts
```
"Plan refactoring of the authentication module"
"Create a technical debt reduction plan"
"Plan migration from legacy code"
```

## Related Documentation
- [Refactoring Specialist Agent](../../agents/refactoring-specialist.md)
- [plan-generator Skill](../../skills/plan-generator/SKILL.md)
