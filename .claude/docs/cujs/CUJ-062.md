# CUJ-062: Skill Integration Validation

## User Goal
Validate that all skills (currently 43) are correctly integrated with their respective agents and trigger properly in workflows.

## Trigger
- "Validate skill integration"
- "Test all skills"
- "Check skill-agent mapping"
- "Verify skill invocations"

## Workflow

**Execution Mode**: `automated-workflow`

### Step 0: Planning Phase
- **Agent**: Planner
- **Input**: Skill validation requirements
- **Output**: Validation plan (`plan-{id}.json`)

### Step 0.1: Plan Rating Gate
- **Agent**: Orchestrator
- **Skill**: response-rater
- **Minimum Score**: 7/10

### Step 1: Skill Discovery and Inventory
- **Agent**: Developer
- **Actions**:
  - Scan `.claude/skills/` directory
  - Parse all SKILL.md files
  - Extract skill metadata (name, agents, triggers)
  - Create skill inventory
- **Output**: Skill inventory (`skill-inventory-{id}.json`)

### Step 2: Agent-Skill Mapping Validation
- **Agent**: QA
- **Actions**:
  - Load `.claude/context/skill-integration-matrix.json`
  - Validate all 34 agents have skill mappings
  - Verify required vs recommended skills
  - Check for missing skill integrations
- **Output**: Mapping validation report (`skill-mapping-validation-{id}.json`)

### Step 3: Skill Invocation Testing
- **Agent**: QA
- **Actions**:
  - Test each skill with natural language invocation
  - Test each skill with Skill tool invocation
  - Verify skill triggers activate correctly
  - Validate skill outputs match schemas
- **Output**: Invocation test results (`skill-invocation-results-{id}.json`)

### Step 4: Workflow Integration Testing
- **Agent**: QA
- **Actions**:
  - Test skills in workflow context
  - Verify skill chaining works correctly
  - Test skill error handling
  - Validate skill artifact generation
- **Output**: Workflow integration report (`workflow-skill-integration-{id}.json`)

### Step 5: Skill Performance Testing
- **Agent**: Performance-Engineer
- **Actions**:
  - Measure skill execution time
  - Profile skill resource usage
  - Test skill scalability
  - Identify performance bottlenecks
- **Output**: Performance report (`skill-performance-{id}.json`)

### Step 6: Cross-Platform Skill Validation
- **Agent**: Cursor-Validator
- **Actions**:
  - Test skills in Claude Code
  - Test skills in Cursor
  - Test skills in Factory Droid
  - Document platform-specific behavior
- **Output**: Cross-platform report (`skill-cross-platform-{id}.json`)

### Step 7: Issue Resolution
- **Agent**: Developer
- **Actions**:
  - Fix skill integration issues
  - Update skill documentation
  - Improve skill error messages
  - Re-test failed skills
- **Output**: Updated skill code and documentation

### Step 8: Final Validation
- **Agent**: Code-Reviewer
- **Actions**:
  - Review skill integration fixes
  - Validate all skills working correctly
  - Approve skill integration
  - Update skill-integration-matrix.json

## Agents Used
- Planner (validation strategy)
- Developer (skill discovery, issue resolution)
- QA (mapping validation, invocation testing, workflow testing)
- Performance-Engineer (performance testing)
- Cursor-Validator (cross-platform testing)
- Code-Reviewer (final validation)

## Skills Used
- `skill-manager` - Skill lifecycle management
- `plan-generator` - Validation planning
- `response-rater` - Plan validation
- `dependency-analyzer` - Skill dependency analysis

## Expected Outputs
- Skill inventory: `.claude/context/artifacts/skill-inventory-{id}.json`
- Mapping validation: `.claude/context/artifacts/skill-mapping-validation-{id}.json`
- Invocation results: `.claude/context/artifacts/skill-invocation-results-{id}.json`
- Workflow integration: `.claude/context/artifacts/workflow-skill-integration-{id}.json`
- Performance report: `.claude/context/artifacts/skill-performance-{id}.json`
- Cross-platform report: `.claude/context/artifacts/skill-cross-platform-{id}.json`

## Success Criteria
- [ ] All skills discovered and inventoried (currently 43 skills)
- [ ] All agents have correct skill mappings (currently 34 agents)
- [ ] All required skills accessible to agents
- [ ] Natural language invocation works for all skills
- [ ] Skill tool invocation works for all skills
- [ ] Skills trigger correctly in workflows
- [ ] Skill outputs match expected schemas
- [ ] No critical skill integration issues
- [ ] Performance within acceptable limits
- [ ] Cross-platform compatibility validated

## Skill Categories to Validate

### 1. Core Skills (6)
- repo-rag
- artifact-publisher
- context-bridge
- rule-auditor
- rule-selector
- scaffolder

### 2. Memory Skills (2)
- memory-manager
- memory

### 3. Document Skills (3)
- excel-generator
- powerpoint-generator
- pdf-generator

### 4. Analysis Skills (4)
- evaluator
- classifier
- summarizer
- text-to-sql

### 5. Tool Skills (3)
- tool-search
- mcp-converter
- skill-manager

### 6. Code Gen Skills (7)
- claude-md-generator
- plan-generator
- diagram-generator
- test-generator
- api-contract-generator
- dependency-analyzer
- doc-generator

### 7. Validation Skills (3)
- code-style-validator
- commit-validator
- response-rater

### 8. Recovery Skills (3)
- recovery
- conflict-resolution
- optional-artifact-handler

### 9. Enforcement Skills (4)
- migrating-rules
- explaining-rules
- fixing-rule-violations
- recommending-rules

### 10. MCP-Converted Skills (9)
- sequential-thinking
- filesystem
- git
- github
- puppeteer
- chrome-devtools
- memory (MCP)
- cloud-run
- computer-use

## Skill Invocation Test Matrix

```json
{
  "test_cases": [
    {
      "skill": "scaffolder",
      "agent": "developer",
      "invocation_method": "natural_language",
      "test_input": "Scaffold a React component for UserProfile",
      "expected_output": "React component boilerplate",
      "trigger": "new component creation"
    },
    {
      "skill": "rule-auditor",
      "agent": "developer",
      "invocation_method": "skill_tool",
      "test_input": "Audit src/components/UserProfile.tsx",
      "expected_output": "Rule violation report",
      "trigger": "code changes"
    },
    {
      "skill": "response-rater",
      "agent": "orchestrator",
      "invocation_method": "natural_language",
      "test_input": "Rate this plan for quality",
      "expected_output": "Rating score (0-10) with feedback",
      "trigger": "plan created"
    }
  ]
}
```

## Agent-Skill Integration Tests

### Required Skills Testing
Test that each agent has access to its required skills:
```
For each agent in skill-integration-matrix.json:
  1. Load agent's required skills
  2. Attempt to invoke each required skill
  3. Verify skill executes successfully
  4. Validate output matches expectations
```

### Recommended Skills Testing
Test that recommended skills enhance agent capabilities:
```
For each agent in skill-integration-matrix.json:
  1. Load agent's recommended skills
  2. Test skill availability
  3. Validate skill provides added value
  4. Document skill usage patterns
```

### Triggered Skills Testing
Test that skills trigger correctly based on conditions:
```
For each skill trigger in skill-integration-matrix.json:
  1. Simulate trigger condition
  2. Verify skill activates automatically
  3. Validate skill execution
  4. Confirm proper cleanup
```

## Test Scenarios

### Scenario 1: Natural Language Skill Invocation
```
1. Agent: developer
2. Input: "Audit this code for rule violations"
3. Expected: rule-auditor skill invoked
4. Validate: Skill executes, returns violation report
5. Verify: Violations include line numbers and fixes
```

### Scenario 2: Skill Tool Invocation
```
1. Agent: developer
2. Use Skill tool with skill_name="scaffolder"
3. Parameters: {component_type: "React", name: "UserProfile"}
4. Expected: Scaffolder generates React component boilerplate
5. Verify: Generated code follows project conventions
```

### Scenario 3: Workflow-Triggered Skill
```
1. Execute greenfield-fullstack workflow
2. At Step 0.1, response-rater should auto-trigger
3. Verify: Plan rated with score >= 7
4. Confirm: Rating recorded in artifact
5. Validate: Workflow proceeds only if score >= 7
```

### Scenario 4: Skill Chaining
```
1. Agent: developer
2. Invoke scaffolder to generate component
3. Auto-invoke rule-auditor to validate generated code
4. Auto-invoke test-generator to create tests
5. Verify: All skills execute in sequence correctly
```

### Scenario 5: Skill Error Handling
```
1. Agent: developer
2. Invoke rule-auditor with invalid file path
3. Expected: Graceful error message
4. Verify: Error includes actionable feedback
5. Confirm: Workflow continues or retries appropriately
```

## Performance Benchmarks

**Skill Execution Time Targets**:
- Lightweight skills (rule-auditor, classifier): < 2 seconds
- Medium skills (scaffolder, test-generator): < 10 seconds
- Heavy skills (repo-rag, dependency-analyzer): < 30 seconds
- Document generation (excel, powerpoint, pdf): < 60 seconds

**Resource Usage Targets**:
- Memory: < 500MB per skill invocation
- CPU: < 50% average utilization
- Context loading: < 5 seconds

## Example Prompts
```
"Validate that all skills are correctly integrated"
"Test scaffolder skill with natural language invocation"
"Verify response-rater triggers correctly in workflows"
"Run integration tests for all 43 skills"
"Check skill-agent mapping for developer agent"
```

## Related Documentation
- [skill-integration-matrix.json](../../context/skill-integration-matrix.json) - **Primary reference for agent-skill mappings**
- [AGENT_SKILL_MATRIX.md](../AGENT_SKILL_MATRIX.md) - Human-readable agent-skill matrix
- [skill-manager Skill](../../skills/skill-manager/SKILL.md) - Skill lifecycle management
- [All Skills](../../skills/) - Complete skill documentation

## Related CUJs
- [CUJ-061: Artifact Publishing](./CUJ-061.md) - Artifact publishing workflow

## Skill Integration Validation Checklist

### Discovery Phase
- [ ] All skills discovered in `.claude/skills/` (currently 43 skills)
- [ ] Skill metadata extracted from SKILL.md files
- [ ] Skill inventory created
- [ ] Skill categories validated

### Mapping Validation
- [ ] skill-integration-matrix.json loaded
- [ ] All agents have skill mappings (currently 34 agents)
- [ ] Required skills verified for each agent
- [ ] Recommended skills documented
- [ ] Triggered skills identified

### Invocation Testing
- [ ] Natural language invocation tested for all skills
- [ ] Skill tool invocation tested for all skills
- [ ] Skill triggers validated
- [ ] Skill outputs validated against schemas
- [ ] Error handling tested

### Workflow Integration
- [ ] Skills tested in workflow context
- [ ] Skill chaining validated
- [ ] Auto-triggered skills verified
- [ ] Artifact generation confirmed

### Performance Testing
- [ ] Execution time measured for all skills
- [ ] Resource usage profiled
- [ ] Performance bottlenecks identified
- [ ] Scalability tested

### Cross-Platform Testing
- [ ] Skills tested in Claude Code
- [ ] Skills tested in Cursor
- [ ] Skills tested in Factory Droid
- [ ] Platform-specific behavior documented

### Issue Resolution
- [ ] Integration issues identified
- [ ] Fixes implemented
- [ ] Documentation updated
- [ ] Re-testing completed

### Final Validation
- [ ] All skills working correctly
- [ ] Skill-integration-matrix.json updated
- [ ] Documentation complete
- [ ] Validation report published

## Known Issues and Workarounds

### Issue: Skill Not Found
**Symptom**: "Skill 'skill-name' not found" error
**Workaround**: Verify skill exists in `.claude/skills/skill-name/SKILL.md`
**Resolution**: Check skill name spelling, verify SKILL.md exists

### Issue: Skill Trigger Not Activating
**Symptom**: Skill doesn't auto-trigger when expected
**Workaround**: Invoke skill manually using Skill tool
**Resolution**: Update trigger conditions in skill-integration-matrix.json

### Issue: Cross-Platform Incompatibility
**Symptom**: Skill works in Claude Code but not Cursor
**Workaround**: Use platform-specific skill variant
**Resolution**: Implement platform compatibility layer

## Metrics and Reporting

**Validation Metrics**:
- Skill discovery rate: 100% (43/43 skills found)
- Integration success rate: >= 95% (41/43 skills working)
- Performance compliance: >= 90% within targets
- Cross-platform compatibility: >= 85% (3 platforms)

**Reporting Format**:
```json
{
  "validation_timestamp": "2026-01-05T10:00:00Z",
  "total_skills": 43,
  "skills_tested": 43,
  "skills_passed": 41,
  "skills_failed": 2,
  "success_rate": 0.953,
  "failed_skills": [
    {
      "skill": "skill-name",
      "reason": "Integration issue",
      "agent": "developer",
      "status": "investigating"
    }
  ]
}
```
